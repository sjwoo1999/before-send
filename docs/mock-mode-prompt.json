{
    "task": "Enable Mock/Simulation Mode for Before Send MVP",
    "description": "Update the Before Send application to run in mock mode without requiring Supabase database or Claude API connections. This allows immediate testing and demonstration of the full user flow.",
    "objectives": [
        "Create mock data layer that simulates AI analysis responses",
        "Bypass Supabase authentication and database operations when in mock mode",
        "Enable toggling between mock and production modes via environment variable",
        "Maintain identical UI/UX behavior regardless of mode"
    ],
    "implementation": {
        "environment_variable": {
            "name": "NEXT_PUBLIC_MOCK_MODE",
            "values": [
                "true",
                "false"
            ],
            "default": "false",
            "description": "When 'true', all API calls return mock data without external dependencies"
        },
        "files_to_create": [
            {
                "path": "src/lib/mock/mockAnalysis.ts",
                "purpose": "Mock Claude AI responses with realistic Korean message analysis",
                "exports": [
                    "getMockAnalysis(originalMessage: string): ClaudeResponse"
                ]
            },
            {
                "path": "src/lib/mock/mockHistory.ts",
                "purpose": "In-memory storage for mock history during session",
                "exports": [
                    "mockHistoryStore",
                    "addMockCheck",
                    "getMockChecks",
                    "deleteMockCheck"
                ]
            }
        ],
        "files_to_modify": [
            {
                "path": "src/app/api/check/route.ts",
                "changes": [
                    "Check NEXT_PUBLIC_MOCK_MODE at start of POST handler",
                    "If mock mode: skip Supabase auth, skip Claude API, use getMockAnalysis()",
                    "Store result in mockHistoryStore instead of database"
                ]
            },
            {
                "path": "src/app/api/check/[id]/route.ts",
                "changes": [
                    "In mock mode: fetch from mockHistoryStore or tempStorage",
                    "Skip Supabase auth check"
                ]
            },
            {
                "path": "src/app/api/history/route.ts",
                "changes": [
                    "In mock mode: return getMockChecks() instead of Supabase query"
                ]
            },
            {
                "path": "src/lib/supabase/server.ts",
                "changes": [
                    "Add isMockMode() helper function",
                    "Gracefully handle missing environment variables in mock mode"
                ]
            }
        ]
    },
    "mock_data_specification": {
        "tone_analysis_rules": {
            "keywords_aggressive": [
                "ì™œ",
                "ë§¨ë‚ ",
                "í•­ìƒ",
                "ë„ëŒ€ì²´",
                "ì§„ì§œ"
            ],
            "keywords_defensive": [
                "ê·¸ê²Œ ì•„ë‹ˆë¼",
                "ë‚´ ì˜ëª»ì´ ì•„ë‹ˆ",
                "ë„ˆì•¼ë§ë¡œ"
            ],
            "keywords_passive_aggressive": [
                "ì•Œê² ì–´",
                "ê·¸ë˜ ì•Œì•˜ì–´",
                "ë­ ì¢‹ì„ëŒ€ë¡œ"
            ],
            "default": "neutral"
        },
        "mock_revisions": {
            "soft": "Transform to warm, empathetic tone",
            "neutral": "Transform to fact-focused, minimal emotion",
            "assertive": "Transform to clear boundaries, respectful firm"
        },
        "mock_highlights": {
            "detect_patterns": [
                {
                    "pattern": "ì™œ.*í•´",
                    "type": "accusatory_question"
                },
                {
                    "pattern": "ë§¨ë‚ |í•­ìƒ|ëŠ˜",
                    "type": "generalization"
                },
                {
                    "pattern": "í•œì‹¬|ë°”ë³´|ë©ì²­",
                    "type": "insult"
                }
            ]
        }
    },
    "testing_scenarios": [
        {
            "name": "Aggressive message",
            "input": "ë„ˆ ì™œ ë§¨ë‚  ê·¸ ëª¨ì–‘ì´ì•¼? ì§„ì§œ í•œì‹¬í•˜ë‹¤",
            "expected_tone": "aggressive",
            "expected_risk": "high",
            "expected_highlights": [
                "ë§¨ë‚ ",
                "í•œì‹¬í•˜ë‹¤"
            ]
        },
        {
            "name": "Neutral message",
            "input": "ë‚´ì¼ 3ì‹œì— íšŒì˜ ìˆëŠ”ë° ì°¸ì„ ê°€ëŠ¥í•˜ì‹ ê°€ìš”?",
            "expected_tone": "neutral",
            "expected_risk": "low",
            "expected_highlights": []
        },
        {
            "name": "Passive aggressive",
            "input": "ì•Œê² ì–´ìš”. ë­ ë§¨ë‚  ê·¸ëŸ¬ì‹œë‹ˆê¹Œ ì €ì•¼ ë­ ìƒê´€ì—†ì£ ",
            "expected_tone": "passive_aggressive",
            "expected_risk": "medium",
            "expected_highlights": [
                "ë§¨ë‚ ",
                "ìƒê´€ì—†ì£ "
            ]
        }
    ],
    "activation": {
        "development": "Add NEXT_PUBLIC_MOCK_MODE=true to .env.local",
        "demo": "Deploy with mock mode enabled for demos without API costs",
        "production": "Ensure NEXT_PUBLIC_MOCK_MODE is false or unset"
    },
    "ui_indicators": {
        "mock_badge": {
            "show_when": "NEXT_PUBLIC_MOCK_MODE === 'true'",
            "position": "fixed bottom-right corner",
            "text": "ğŸ§ª Mock Mode",
            "purpose": "Clearly indicate to testers that mock mode is active"
        }
    }
}